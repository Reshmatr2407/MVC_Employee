@{
    ViewData["Title"] = "Insert Employee";
}

<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>@ViewData["Title"]</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <style>
        /* Your existing styles */
    </style>
</head>
<body>
    <h1>Insert Employee Details</h1>

    <form id="employeeForm" onsubmit="return insert();">
        <div class="mb-3">
            <label for="emp_code" class="form-label">Employee Code:</label>
            <input type="number" class="form-control" name="EmpCode" id="emp_code" required>
        </div>

        <div class="mb-3">
            <label for="emp_name" class="form-label">Employee Name:</label>
            <input type="text" class="form-control" name="EmpName" id="emp_name" required>
        </div>

        <div class="mb-3">
            <label for="des" class="form-label">Designation:</label>
            <input type="text" class="form-control" name="Designation" id="des" required>
        </div>

        <div class="mb-3">
            <label for="dep" class="form-label">Department:</label>
            <input type="text" class="form-control" name="Department" id="dep" required>
        </div>

        <input type="submit" value="Insert Employee">
    </form>

    <script>
function insert() {
    var employeeData = {
        postdto: { // Wrap the data in the expected property
            flag: "insert_1",
            empId: $('#emp_code').val(), // Convert to string
            empName: $('#emp_name').val(),
            designation: $('#des').val(),
            department: $('#dep').val()
        }
    };

    console.log(JSON.stringify(employeeData)); // Log the employee data

    $.ajax({
        type: "POST",
        url: '@Url.Action("postAPIData", "EmployeeNew")', // Ensure the action name matches
        data: JSON.stringify(employeeData), // Send the wrapped employeeData
        contentType: "application/json",
        success: function (response) {
            alert("Successfully inserted: " + response);
        },
        error: function (xhr) {
            if (xhr.status === 400) {
                var errors = JSON.parse(xhr.responseText);
                alert("Validation errors: " + JSON.stringify(errors));
            } else {
                alert("Error inserting employee: " + xhr.statusText);
            }
        }
    });

    return false; // Prevent default form submission
}

    </script>
</body>
</html>
